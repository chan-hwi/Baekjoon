# [Platinum II] 수열과 쿼리의 부분합의 합 - 25387 

[문제 링크](https://www.acmicpc.net/problem/25387) 

### 성능 요약

메모리: 30144 KB, 시간: 440 ms

### 분류

자료 구조(data_structures), 느리게 갱신되는 세그먼트 트리(lazyprop), 수학(math), 세그먼트 트리(segtree), 스위핑(sweeping)

### 문제 설명

<p>길이가 $N$인 수열 $a_1,a_2,\cdots ,a_N$이 있다. 처음에 모든 $a_i$는 $0$이다. 이때, 다음과 같은 쿼리를 사용해 수열 $a$를 변화시킬 수 있다.</p>

<p style="text-align:center;">$l r c$: 수열 $a$의 $l$번째부터 $r$번째까지의 값을 $c$로 바꾼다.</p>

<p>$Q$개의 쿼리가 주어질 때, $f(U,D,L,R)$을 ‘$U$번째부터 $D$번째까지의 쿼리를 순서대로 사용했을 때 $a_L+a_{L+1}+\cdots +a_R$의 값’으로 정의한다. $f$를 여러 번 시행할 경우, 각 시행은 서로 독립적이라 이전 $f$의 시행이 현재 $f$의 시행에 영향을 주지 않는다.</p>

<p>$\sum_{U=1}^Q\sum_{D=U}^Q\sum_{L=1}^N\sum_{R=L}^Nf(U,D,L,R)$을 $998\, 244\, 353$$(=119\times 2^{23}+1)$으로 나눈 나머지를 계산해 보자. $998\, 244\, 353$은 소수이다.</p>

### 입력 

 <p>첫 번째 줄에 정수 $N$, $Q$가 공백으로 구분되어 주어진다. $(1\leq N,Q\leq 300\, 000)$</p>

<p>두 번째 줄부터 $Q$개의 줄에 걸쳐 $Q$개의 쿼리가 한 줄에 하나씩 순서대로 주어진다. $i$번째 쿼리로 세 개의 정수 $l_i$, $r_i$, $c_i$이 공백으로 구분되어 주어진다. $(1\leq l_i\leq r_i\leq N;$ $0\leq c_i<998\, 244\, 353)$</p>

### 출력 

 <p>$\sum_{U=1}^Q\sum_{D=U}^Q\sum_{L=1}^N\sum_{R=L}^Nf(U,D,L,R)$를 $998\, 244\, 353$으로 나눈 나머지를 출력하시오.</p>

